<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
<link rel="icon" href=favicon_dh.ico type="image/gif">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
  <link
          href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
          rel="stylesheet">
</noscript>


<link rel="stylesheet" href="/css/font.css" media="all">



<meta property="og:url" content="https://hhook.github.io/blogs/05_anz_virtual_experience/">
  <meta property="og:site_name" content="Datahook: Helena">
  <meta property="og:title" content="ANZ Virtual Internship">
  <meta property="og:description" content="This is a post about a virtual work experience program I completed with Forage in their collaboration with ANZ, an Australian multinational banking and financial services company.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blogs">
    <meta property="article:published_time" content="2020-11-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-11-30T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Linear Regression">
    <meta property="article:tag" content="Gradient Boosting">
    <meta property="article:tag" content="Scikit-Learn">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ANZ Virtual Internship">
  <meta name="twitter:description" content="This is a post about a virtual work experience program I completed with Forage in their collaboration with ANZ, an Australian multinational banking and financial services company.">


<link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css" media="all"><link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">

<style>
    :root {
        --text-color: #343a40;
        --text-secondary-color: #5a5b5c;
        --text-link-color: #5a5b5c;
        --background-color: #eeeee4;
        --secondary-background-color: #ee8335;
        --primary-color: #5a5b5c;
        --secondary-color: #f8f9fa;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --text-link-color-dark: #096cd6;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }

    html {
        background-color: var(--background-color) !important;
    }

    body::-webkit-scrollbar {
        height: 0px;
        width: 8px;
        background-color: var(--background-color);
    }

    ::-webkit-scrollbar-track {
        border-radius: 1rem;
    }

    ::-webkit-scrollbar-thumb {
        border-radius: 1rem;
        background: #b0b0b0;
        outline: 1px solid var(--background-color);
    }

    #search-content::-webkit-scrollbar {
        width: .5em;
        height: .1em;
        background-color: var(--background-color);
    }
</style>



<meta name="description" content="">
<link rel="stylesheet" href="/css/single.css">


<script defer src="/fontawesome-6/all-6.4.2.js"></script>


  
  

  <title>
ANZ Virtual Internship | Datahook: Helena

  </title>
</head>

<body class="light">
  
  
<script>
    let localStorageValue = localStorage.getItem("pref-theme");
    let mediaQuery = window.matchMedia('(prefers-color-scheme: dark)').matches;

    switch (localStorageValue) {
        case "dark":
            document.body.classList.add('dark');
            break;
        case "light":
            document.body.classList.remove('dark');
            break;
        default:
            if (mediaQuery) {
                document.body.classList.add('dark');
            }
            break;
    }
</script>




<script>
    var prevScrollPos = window.pageYOffset;
    window.addEventListener("scroll", function showHeaderOnScroll() {
        let profileHeaderElem = document.getElementById("profileHeader");
        let currentScrollPos = window.pageYOffset;
        let resetHeaderStyle = false;
        let showNavBarOnScrollUp =  true ;
        let showNavBar = showNavBarOnScrollUp ? prevScrollPos > currentScrollPos : currentScrollPos > 0;
        if (showNavBar) {
            profileHeaderElem.classList.add("showHeaderOnTop");
        } else {
            resetHeaderStyle = true;
        }
        if(currentScrollPos === 0) {
            resetHeaderStyle = true;
        }
        if(resetHeaderStyle) {
            profileHeaderElem.classList.remove("showHeaderOnTop");
        }
        prevScrollPos = currentScrollPos;
    });
</script>



<header id="profileHeader">
    <nav class="pt-3 navbar navbar-expand-lg animate">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/favicon_dh.ico" width="30" height="30"
                    class="d-inline-block align-top">
                Data Hook
                
            </a>

            
                <div>
                    <input id="search" autocomplete="off" class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl &#43; k to Search...'
                        aria-label="Search" oninput="searchOnChange(event)">
                </div>
            

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                        <li class="nav-item navbar-text d-block d-md-none">
                            <div class="nav-link">
                                <input id="search" autocomplete="off" class="form-control mr-sm-2" placeholder='Ctrl &#43; k to Search...' aria-label="Search" oninput="searchOnChange(event)">
                            </div>
                        </li>
                    

                    

                    

                    

                    

                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#contact"
                            aria-label="contact">
                            Contact
                        </a>
                    </li>
                    

                    

                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/cv/helena_hook_cv.pdf" title="Download CV">
                            
                            CV
                        </a>
                    </li>
                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/blogs" title="Blog posts">
                            
                            Blog
                        </a>
                    </li>
                    
                    

                    

                </ul>

            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">ANZ Virtual Internship</h1>
            <div class="text-center">
              
              Nov 30, 2020

              
              <span id="readingTime">
                min read
              </span>
              
            </div>
          </div>
          
          <article class="page-content  p-2">
          <p>This is a post about a virtual work experience program I completed with <a href="https://www.theforage.com/virtual-internships/prototype/ZLJCsrpkHo9pZBJNY/ANZ-Virtual-Internship">Forage</a> in their collaboration with ANZ, an Australian multinational banking and financial services company.</p>
<h3 id="overview">Overview</h3>
<p>The virtual work experiences contain a series of resources and tasks designed to simulate the real-world experience.
This task is based on a synthesised transaction dataset containing 3 months’ worth of transactions for 100 hypothetical customers. It contains purchases, recurring transactions, and salary transactions.</p>
<p>The dataset is designed to simulate realistic transaction behaviours that are observed in ANZ’s real transaction data, so many of the insights you can gather from the tasks below will be genuine.</p>
<p>This task will involve exploratory data analysis, feature engineering and predicting customers&rsquo; annual salary based on their transactions.</p>
<p>Have a look at this <a href="https://public.tableau.com/profile/helena.hook#!/vizhome/Transactiondatainsights/Dashboard">interactive data dashboard</a> too. And if you would like to deep dive into the code, here is a link to the <a href="https://github.com/HHook/ANZ-virtual-internship">github repository</a>.</p>
<h3 id="exploratory-data-analysis">Exploratory Data Analysis</h3>
<p>The dataset given has 12 043 records with 23 columns.</p>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 12043 entries, 0 to 12042
Data columns (total 23 columns):
 #   Column             Non-Null Count  Dtype         
---  ------             --------------  -----         
 0   status             12043 non-null  object        
 1   card_present_flag  7717 non-null   float64       
 2   bpay_biller_code   885 non-null    object        
 3   account            12043 non-null  object        
 4   currency           12043 non-null  object        
 5   long_lat           12043 non-null  object        
 6   txn_description    12043 non-null  object        
 7   merchant_id        7717 non-null   object        
 8   merchant_code      883 non-null    float64       
 9   first_name         12043 non-null  object        
 10  balance            12043 non-null  float64       
 11  date               12043 non-null  datetime64[ns]
 12  gender             12043 non-null  object        
 13  age                12043 non-null  int64         
 14  merchant_suburb    7717 non-null   object        
 15  merchant_state     7717 non-null   object        
 16  extraction         12043 non-null  object        
 17  amount             12043 non-null  float64       
 18  transaction_id     12043 non-null  object        
 19  country            12043 non-null  object        
 20  customer_id        12043 non-null  object        
 21  merchant_long_lat  7717 non-null   object        
 22  movement           12043 non-null  object        
dtypes: datetime64[ns](1), float64(4), int64(1), object(17)
memory usage: 2.1+ MB
</code></pre>
<p>75% of customers are between age 18 and 38, median age 28.


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/age%20dist%20V.jpg" data-fancybox-group="">
  
    <img class="fig-img" src="/images/age%20dist%20V.jpg" >
  
    </a>
  
  
</div>
</p>
<p>Difference in average salary by gender<br>
Males: 2077.94 AUD, Females: 1679.37 AUD.


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/avg%20salary%20by%20gender%20V.jpg" data-fancybox-group="">
  
    <img class="fig-img" src="/images/avg%20salary%20by%20gender%20V.jpg" >
  
    </a>
  
  
</div>
</p>
<p>Average purchase transaction <em>(POS transactions)</em> amount is 39.8 AUD and every customer makes 27 of them on average every month.</p>
<p>Average week purchase volume and amount.


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/avg%20trans%20by%20week%20V.jpg" data-fancybox-group="">
  
    <img class="fig-img" src="/images/avg%20trans%20by%20week%20V.jpg" >
  
    </a>
  
  
</div>
</p>
<p>Average day purchase volume and amount.<br>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/avg%20trans%20by%20hour%20V.jpg" data-fancybox-group="">
  
    <img class="fig-img" src="/images/avg%20trans%20by%20hour%20V.jpg" >
  
    </a>
  
  
</div>
   </p>
<h3 id="feature-engineering">Feature engineering</h3>
<p>To understand our customer better, we will construct some new features that relate to their purchasing behaviours.</p>
<p>Create features like which state does the customer live in, how many purchases they make weekly, what is their average purchase amount, how many big purchases they make and what is their average balance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>customer_state <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>avg_weekly_purch_num <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>avg_weekly_trans_num <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>no_trans_days <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>avg_trans_amount <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>max_amount <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>num_large_trans <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>avg_trans_amount_overall <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>med_balance <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]:
</span></span><span style="display:flex;"><span>    customer_state<span style="color:#f92672">.</span>append(customer_state_df[customer_state_df[<span style="color:#e6db74">&#39;id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;state&#39;</span>]<span style="color:#f92672">.</span>item())
</span></span><span style="display:flex;"><span>    avg_weekly_purch_num<span style="color:#f92672">.</span>append(int(weekly_purch<span style="color:#f92672">.</span>loc[i]))
</span></span><span style="display:flex;"><span>    avg_weekly_trans_num<span style="color:#f92672">.</span>append(int(weekly_trans<span style="color:#f92672">.</span>loc[i]))
</span></span><span style="display:flex;"><span>    no_trans_days<span style="color:#f92672">.</span>append(pos_df[pos_df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>nunique())
</span></span><span style="display:flex;"><span>    avg_trans_amount<span style="color:#f92672">.</span>append(int(round(pos_df[pos_df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">.</span>mean(), <span style="color:#ae81ff">0</span>)))
</span></span><span style="display:flex;"><span>    max_amount<span style="color:#f92672">.</span>append(round(pos_df[pos_df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">.</span>max(), <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    num_large_trans<span style="color:#f92672">.</span>append(pos_df[(pos_df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i) <span style="color:#f92672">&amp;</span> (pos_df[<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">100</span>)][<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">.</span>count())
</span></span><span style="display:flex;"><span>    avg_trans_amount_overall<span style="color:#f92672">.</span>append(int(round(df[df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">.</span>mean(), <span style="color:#ae81ff">0</span>)))
</span></span><span style="display:flex;"><span>    med_balance<span style="color:#f92672">.</span>append(df[df[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">==</span>i][<span style="color:#e6db74">&#39;balance&#39;</span>]<span style="color:#f92672">.</span>median())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;state&#39;</span>] <span style="color:#f92672">=</span> customer_state
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;avg_weekly_purch_num&#39;</span>] <span style="color:#f92672">=</span> avg_weekly_purch_num
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;avg_weekly_trans_num&#39;</span>] <span style="color:#f92672">=</span> avg_weekly_trans_num
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;no_trans_days&#39;</span>] <span style="color:#f92672">=</span> no_trans_days
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;avg_trans_amount&#39;</span>] <span style="color:#f92672">=</span> avg_trans_amount
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;max_amount&#39;</span>] <span style="color:#f92672">=</span> max_amount
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;num_large_trans&#39;</span>] <span style="color:#f92672">=</span> num_large_trans
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;avg_trans_amount_overall&#39;</span>] <span style="color:#f92672">=</span> avg_trans_amount_overall
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;med_balance&#39;</span>] <span style="color:#f92672">=</span> med_balance
</span></span></code></pre></div><p> </p>
<h5 id="age-bins">Age bins</h5>
<p>We will also bin the customer age to one four categories: below 20, between 20 and 40, between 40 and 60, over 60.</p>
<p> </p>
<h5 id="annual-salary-for-each-customer">Annual salary for each customer</h5>
<p>Find only salary payments.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_salaries <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#39;txn_description&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;PAY/SALARY&#39;</span>]<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;customer_id&#39;</span>)<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><p>Every customer in the dataset has a different frequency for receiving their salary, some get paid once a month, some every week. To find an average monthly salary we will sum up all their payments in the three months of data we have and divide it by three.  To then get the annual salary we multiply the average monthly salary with 12.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>annual_salaries <span style="color:#f92672">=</span> df_salaries[<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span><span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> <span style="color:#75715e"># annual salary for each customer</span>
</span></span></code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/annual_salary_dist_V.jpg" data-fancybox-group="">
  
    <img class="fig-img" src="/images/annual_salary_dist_V.jpg" >
  
    </a>
  
  
</div>

<p> </p>
<h2 id="predicting-annual-salary">Predicting annual salary</h2>
<p>First we will need to do some dummy encoding on categorical variables like &lsquo;status&rsquo;, &rsquo;txn_description&rsquo;, &lsquo;gender&rsquo;, &lsquo;state&rsquo; and &lsquo;age_bin&rsquo;.</p>
<p>Then check correlation between variabels and &lsquo;annual_salary&rsquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>num_feats<span style="color:#f92672">.</span>corr()[<span style="color:#e6db74">&#39;annual_salary&#39;</span>]<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><pre><code>annual_salary           1.000000
avg_trans_amount_ov     0.538656
med_balance             0.258076
balance                 0.257159
amount                  0.091111
avg_trans_amount        0.044312
num_large_trans        -0.045275
avg_weekly_trans_num   -0.079352
max_amount             -0.097739
no_trans_days          -0.172765
avg_weekly_purch_num   -0.189532
Name: annual_salary, dtype: float64
</code></pre>
<p>Here I realised avg_trans_amount_overall is suspiciously highly correlated. I decided to not use this as a feature for our predictive model because the calculation includes salary payments and we are trying to predict customers&rsquo; annual salary just by their purchasing behaviour, without knowing about their salary payments.</p>
<p>For testing, I chose to split our data to 70% train and 30% for test set.</p>
<h3 id="linear-regression">Linear regression</h3>
<p>Let&rsquo;s build a simple linear regression  model with sklearn to predict customers&rsquo; annual salary with features we defined earlier.</p>
<p>Our linear model valuation:</p>
<pre><code>R-squared 0.5381890117545585
MAE: 13706.815968071387
MSE: 323705668.54002833
RMSE: 17991.822268464868
</code></pre>
<p>Plotting the predictions. Our model&rsquo;s predictions are plotted in blue, perfect predictions in red.<br>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/output_39_1.png" data-fancybox-group="">
  
    <img class="fig-img" src="/images/output_39_1.png" >
  
    </a>
  
  
</div>
</p>
<p>Our model&rsquo;s predictions are kind of following the trend, but still too scattered to be trusted. So our linear regression model did not perform the best and this would not be an accurate way to predict customers&rsquo; annual salaries. But let&rsquo;s try using a different model.</p>
<h3 id="gradient-boosting">Gradient boosting</h3>
<p>Gradient boosting is an ensemble learner. This means it will create a final model based on a collection of individual decision tree models.</p>
<p>Our gradient boosting model performed noticably better than the linear regression earlier:</p>
<pre><code>R-squared 0.9842118273179078
MAE: 2476.2601909654327
MSE: 11066694.217258077
RMSE: 3326.66412750943
</code></pre>
<p>Plotting the predictions. Our gradient boosting model’s predictions are plotted in blue, perfect predictions in red.<br>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/output_56_1.png" data-fancybox-group="">
  
    <img class="fig-img" src="/images/output_56_1.png" >
  
    </a>
  
  
</div>
</p>
<p>A gradient descent procedure is used to minimize the loss when adding trees. Our model&rsquo;s loss is minimsed at around 400 trees.


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption " >
  
    <a class="fancybox" href="/images/output_loss.png" data-fancybox-group="">
  
    <img class="fig-img" src="/images/output_loss.png" >
  
    </a>
  
  
</div>
</p>
<h2 id="results">Results</h2>
<p>Our gradient boosting machine definitely outperformed the linear regression model. Should it be used to segment customers whose annual salary we do not have? Maybe not yet. We could definitely do better with more data <em>(real data)</em> and more parameter tuning.</p>
          </article>
        </div>
      </div>
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div id="stickySideBar" class="sticky-sidebar">
          
          <aside class="toc">
              <h5>
                Table Of Contents
              </h5>
              <div class="toc-content">
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
        <li><a href="#feature-engineering">Feature engineering</a></li>
      </ul>
    </li>
    <li><a href="#predicting-annual-salary">Predicting annual salary</a>
      <ul>
        <li><a href="#linear-regression">Linear regression</a></li>
        <li><a href="#gradient-boosting">Gradient boosting</a></li>
      </ul>
    </li>
    <li><a href="#results">Results</a></li>
  </ul>
</nav>
              </div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item"><a href="https://hhook.github.io/tags/python"
                target="_blank"
              >python</a></li>
              
              <li class="list-inline-item"><a href="https://hhook.github.io/tags/linear-regression"
                target="_blank"
              >linear regression</a></li>
              
              <li class="list-inline-item"><a href="https://hhook.github.io/tags/gradient-boosting"
                target="_blank"
              >gradient boosting</a></li>
              
              <li class="list-inline-item"><a href="https://hhook.github.io/tags/scikit-learn"
                target="_blank"
              >scikit-learn</a></li>
              
            </ul>
          </aside>
          

          
          <aside class="social">
            <h5>Social</h5>
            <div class="social-content">
              <ul class="list-inline">
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fhhook.github.io%2fblogs%2f05_anz_virtual_experience%2f">
                    <i class="fab fa-linkedin"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://twitter.com/share?text=ANZ%20Virtual%20Internship&url=https%3a%2f%2fhhook.github.io%2fblogs%2f05_anz_virtual_experience%2f">
                    <i class="fab fa-twitter"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://api.whatsapp.com/send?text=ANZ%20Virtual%20Internship: https%3a%2f%2fhhook.github.io%2fblogs%2f05_anz_virtual_experience%2f">
                    <i class="fab fa-whatsapp"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href='mailto:?subject=ANZ%20Virtual%20Internship&amp;body=Check%20out%20this%20site https%3a%2f%2fhhook.github.io%2fblogs%2f05_anz_virtual_experience%2f'>
                    <i class="fa fa-envelope"></i>
                  </a>
                </li>
              </ul>
            </div>
          </aside>
          
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-4">
        
      </div>
    </div>
  </div>
  <button class="p-2 px-3" onclick="topFunction()" id="topScroll">
    <i class="fas fa-angle-up"></i>
  </button>
</section>


<div class="progress">
  <div id="scroll-progress-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
</div>
<Script src="/js/scrollProgressBar.js"></script>


<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topScroll.style.display = "block";
    } else {
      topScroll.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }

  
  let stickySideBarElem = document.getElementById("stickySideBar");
  let stickyNavBar =  true ;
  if(stickyNavBar) {
    let headerElem = document.getElementById("profileHeader");
    let headerHeight = headerElem.offsetHeight + 15;
    stickySideBarElem.style.top = headerHeight + "px";
  } else {
    stickySideBarElem.style.top = "50px";
  }
</script>


<script src="/js/readingTime.js"></script>



  </div><footer>
    
    

    
<section id="contact" class="py-5">
    <div class="container">
        <h3 class="text-center">Get in Touch</h3>
        <div class="px-0 px-md-5 px-lg-5">
            <div class="row justify-content-center px-md-5">
                <div class="col-md-8 py-3">
                    <div class="text-center">
                        My inbox is always open. Whether you have a question or just want to say hi, I’ll try my best to get back to you!
                    </div>
                    
                    <div class="text-center pt-3">
                        <a 
                            href='
                                    mailto:helena@datahook.co.uk
                                  '
                            target="_blank"
                            class="btn"
                        >
                            Mail me
                        </a>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    <div id="contact-form-status"></div>
</section>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="check-circle-fill" viewBox="0 0 16 16">
    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
  </symbol>
  <symbol id="info-fill" viewBox="0 0 16 16">
    <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
  </symbol>
  <symbol id="exclamation-triangle-fill" viewBox="0 0 16 16">
    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
  </symbol>
</svg>
<div class="text-center pt-2">
    

    

    

    

    
</div><div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-4 text-center">
            
                <div class="pb-2">
                    <a href="https://hhook.github.io/" title="Datahook: Helena">
                        <img alt="Footer logo" src="/favicon_dh.ico"
                            height="40px" width="40px">
                    </a>
                </div>
            
            &copy; 2025  All rights reserved
            <div class="text-secondary">
                Made with
                <span class="text-danger">
                    &#10084;
                </span>
                and
                <a href="https://github.com/gurusabarish/hugo-profile" target="_blank"
                    title="Designed and developed by gurusabarish">
                    Hugo Profile
                </a>
            </div>
        </div>
    </div>
</div>
</footer><script src="/bootstrap-5/js/bootstrap.bundle.min.js"></script>
<script>
    if (document.body.className.includes("dark")) {
        document.body.classList.remove('dark');
        localStorage.setItem("pref-theme", 'light');
    }
</script>




    <script src="/js/search.js"></script>











  <section id="search-content" class="py-2">
    <div class="container" id="search-results"></div>
  </section>
</body>

</html>
